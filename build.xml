<?xml version="1.0" encoding="UTF-8"?>
<project basedir="." name="ise3_contentBuild" default="all">
    <description>
        Builds an ISE3-based website from a TEI dataset.
    </description>

    <taskdef resource="net/sf/antcontrib/antcontrib.properties"/>
    <taskdef name="schematron"
        classpath="lib/ant-schematron-2010-04-14.jar"
        classname="com.schematron.ant.SchematronTask"/>
    
    <target name="all" depends="dist"/>

    <target name="dist" depends="validate">
        <!-- create distribution artifacts, eg. HTML, derived TEI, eXist app -->
        <overridableFilter using="exist-app.properties"/>
        <!--copy todir="dist" filtering="true"/-->
    </target>

    <target name="validate">
        <!-- make sure everything validates according to its schema -->
    </target>

    <macrodef name="overridableFilter">
        <attribute name="using"/>
        <sequential>
            <filter filtersfile="@{using}"/>
            <if>
                <available file="${data}/@{using}"/>
                <then>
                    <filter filtersfile="${data}/@{using}"/>
                </then>
            </if>
        </sequential>
    </macrodef>
</project>
