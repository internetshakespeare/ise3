<?xml version="1.0" encoding="UTF-8"?>
<project basedir="." name="ise3_contentBuild" default="all">
    <description>
        Builds an ISE3-based website from a TEI dataset.
    </description>

    <taskdef resource="net/sf/antcontrib/antcontrib.properties"/>
    <taskdef name="schematron"
        classpath="lib/ant-schematron-2010-04-14.jar"
        classname="com.schematron.ant.SchematronTask"/>

    <import file="anttask/overridable.xml"/>


    <target name="all" depends="validate, build, package"/>

    <target name="validate">
        <!-- make sure everything validates according to its schema -->
    </target>

    <target name="build">
        <!-- TODO: generate derivative TEI, HTML, etc -->
        <mkdir dir="build/data"/>
        <!-- TODO: any processing needed of web resources? -->
        <!-- apply filters to expath-pkg -->
        <overridableFilter using="exist-app.properties"/>
        <copy todir="build/expath-pkg">
            <fileset dir="expath-pkg"/>
        </copy>
    </target>

    <target name="package">
        <overridableProperties using="exist-app.properties"/>
        <zip destfile="build/${abbrev}-${version}.xar">
            <fileset dir="build/expath-pkg"/>
            <zipfileset dir="build/data" prefix="content"/>
            <zipfileset dir="web" prefix="content"/>
        </zip>
    </target>

    <target name="clean">
        <delete dir="build"/>
    </target>

</project>
